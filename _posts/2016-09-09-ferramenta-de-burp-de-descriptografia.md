---
title: 'Ferramenta de Burp de Descriptografia do Protocolo WhatsApp'
date: 2019-12-18T23:11:00+01:00
draft: false
---

[romanzaikin](https://github.com/romanzaikin)/[BurpExtension-WhatsApp-Decryption-CheckPoint](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint)
=========================================================================================================================================================================

[

 Code](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint)[

 Issues 5](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/issues)[

 Pull requests 0](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/pulls)[

 Projects 0](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/projects)[

 Security](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/security/advisories)[

 Insights](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/pulse)

Dismiss

### Join GitHub today

GitHub is home to over 40 million developers working together to host and review code, manage projects, and build software together.

[Sign up](https://github.com/join?source=prompt-code&source_repo=romanzaikin%2FBurpExtension-WhatsApp-Decryption-CheckPoint)

This tool was created during our research at Checkpoint Software Technologies on Whatsapp Protocol (This repository will be updated after BlackHat 2019)

[whatsapp](https://github.com/topics/whatsapp "Topic: whatsapp")[burpsuite-extender](https://github.com/topics/burpsuite-extender "Topic: burpsuite-extender")[protocol-buffers](https://github.com/topics/protocol-buffers "Topic: protocol-buffers")[hacking-tool](https://github.com/topics/hacking-tool "Topic: hacking-tool")

*   [ 34 commits](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/commits/master)
*   [ 1 branch](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/branches)
*   [ 0 packages](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/packages)
*   [ 0 releases](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/releases)
*   [ 4 contributors](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/graphs/contributors)

PythonC

Branch: master New pull request

[Find file](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/find/master)

Clone or download 

[![@romanzaikin](https://avatars2.githubusercontent.com/u/11314384?s=60&v=4)](https://github.com/romanzaikin)

[romanzaikin](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/commits?author=romanzaikin) [Update README.md](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/commit/54705108f2b0ac7533c4fa47babd3c52c511afd6 "Update README.md  new read me") …

Latest commit[5470510](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/commit/54705108f2b0ac7533c4fa47babd3c52c511afd6)on 21 Oct

Type

Name

Latest commit message

Commit time

[helper](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/tree/master/helper "helper")

[error fixed](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/commit/87df232c81c0360f4d4a1e8661aec1597d62b867 "error fixed  error fixed")

4 months ago

[lib](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/tree/master/lib "lib")

[BlackHat 2019 update](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/commit/f833466f56f63891af022989c1b70ee5085fec99 "BlackHat 2019 update  BlackHat 2019 update")

4 months ago

[.gitignore](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/blob/master/.gitignore ".gitignore")

[requiremenets fixed](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/commit/1e19bf5bc9eb7d726689cb29843c9e9492763ce7 "requiremenets fixed  requiremenets fixed")

last year

[README.md](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/blob/master/README.md "README.md")

[Update README.md](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/commit/54705108f2b0ac7533c4fa47babd3c52c511afd6 "Update README.md  new read me")

2 months ago

[burpWhatsapp.py](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/blob/master/burpWhatsapp.py "burpWhatsapp.py")

[BlackHat 2019 update](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/commit/f833466f56f63891af022989c1b70ee5085fec99 "BlackHat 2019 update  BlackHat 2019 update")

4 months ago

[requirements.txt](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/blob/master/requirements.txt "requirements.txt")

[BlackHat 2019 update](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/commit/f833466f56f63891af022989c1b70ee5085fec99 "BlackHat 2019 update  BlackHat 2019 update")

4 months ago

[tool.png](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/blob/master/tool.png "tool.png")

[BlackHat 2019 update](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/commit/f833466f56f63891af022989c1b70ee5085fec99 "BlackHat 2019 update  BlackHat 2019 update")

4 months ago

[working data.txt](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/blob/master/working%20data.txt "working data.txt")

[BlackHat 2019 update](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/commit/f833466f56f63891af022989c1b70ee5085fec99 "BlackHat 2019 update  BlackHat 2019 update")

4 months ago

###  README.md

[](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint?fbclid=IwAR1vVNuPLOQhY31gTefE7uPjr7ZkL5KWES6Rvspm5N0uaJY_JCJnwM20TwU#whatsapp-protocol-decryption-burp-tool)WhatsApp Protocol Decryption Burp Tool
=================================================================================================================================================================================================================================

This tool was created during our research at Checkpoint Software Technologies on Whatsapp Protocol.

Here is the link to our blog post: [https://research.checkpoint.com/fakesapp-a-vulnerability-in-whatsapp/](https://research.checkpoint.com/fakesapp-a-vulnerability-in-whatsapp/)

The Extension:

[![alt tag](https://raw.githubusercontent.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/master/tool.png)](https://raw.githubusercontent.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint/master/tool.png)

Read my book to learn more about web hacking [https://www.amazon.com/dp/1096435497](https://www.amazon.com/dp/1096435497)

[](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint?fbclid=IwAR1vVNuPLOQhY31gTefE7uPjr7ZkL5KWES6Rvspm5N0uaJY_JCJnwM20TwU#made-by)Made By:
--------------------------------------------------------------------------------------------------------------------------------------------------------------------

Dikla Barda

Linkedin - [https://www.linkedin.com/in/diklabarda/](https://www.linkedin.com/in/diklabarda/)

Roman Zaikin

Linkedin - [https://www.linkedin.com/in/romanzaikin/](https://www.linkedin.com/in/romanzaikin/)

Twitter - [https://twitter.com/R0m4nZ41k1n](https://twitter.com/R0m4nZ41k1n)

[](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint?fbclid=IwAR1vVNuPLOQhY31gTefE7uPjr7ZkL5KWES6Rvspm5N0uaJY_JCJnwM20TwU#dependencies)Dependencies:
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

```
* Windows Only(step 3 and 4)  

```

1.  Download Python 2.7 at [https://www.python.org/downloads/release/python-2715/](https://www.python.org/downloads/release/python-2715/)
2.  Download pip at [https://pip.pypa.io/en/stable/installing/](https://pip.pypa.io/en/stable/installing/)
3.  Download Microsoft Visual C++ Compiler for Python 2.7 at [https://www.microsoft.com/en-us/download/confirmation.aspx?id=44266](https://www.microsoft.com/en-us/download/confirmation.aspx?id=44266)
4.  Copy `stdint.h` to `C:\Users\Administrator\AppData\Local\Programs\Common\Microsoft\Visual C++ for Python\9.0\VC\include`
5.  Execute the command `pip install -r requirements.txt`
    *   On Linux/Mac use `python2 -m pip install -r requirements.txt`

[](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint?fbclid=IwAR1vVNuPLOQhY31gTefE7uPjr7ZkL5KWES6Rvspm5N0uaJY_JCJnwM20TwU#about-the-extension)About the extension
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

This extension allow you to view and manipulate the actual data that sent via whatsapp.

1.  Open chrome developer tool and break on keyPair: t, (line 3311) and wait until the keys will appear (5 minutes or so).
2.  Run the decoder server which is `parser.py` (in helper dir).
3.  Install `burpWhatsapp.py` to your burp suite extensions.
4.  Break get the keys from step 1.
5.  get the secret parameter from the websocket in burp websocket history.

[](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint?fbclid=IwAR1vVNuPLOQhY31gTefE7uPjr7ZkL5KWES6Rvspm5N0uaJY_JCJnwM20TwU#functionality)Functionality
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

1.  Decrypt incoming data, you have to paste the data as base64 to the extension `ctrl+b`
2.  Encrypt incoming data, after you decrypt the data you can encrypt and put it back to burp by copy pase the base64 and `ctrl+shift+b`
3.  Decrypt outgoing data, to decrypt outgoing data you have to take it from `AesCbcEncrypt` function in list format.
4.  Encrypt outgoing data, after the extension encrypt the data back you have to put it back via the console.

you can use the following helper function to do that:

```
function str2unit8(str) {  
  var buf \= new ArrayBuffer(str.length);  
  var bufView \= new Uint8Array(buf);  
    
  for (var i\=0, strLen\=str.length; i < strLen; i++) {  
    bufView\[i\] \= str\[i\];  
  }  
  return buf;  
}
```

[](https://github.com/romanzaikin/BurpExtension-WhatsApp-Decryption-CheckPoint?fbclid=IwAR1vVNuPLOQhY31gTefE7uPjr7ZkL5KWES6Rvspm5N0uaJY_JCJnwM20TwU#to-do)TO-DO
---------------------------------------------------------------------------------------------------------------------------------------------------------------

The extension currently can decrypt and encrypt only the message related functionality, in order to add more function you have to map the protobuf and add it to our protobuf file.