---
title: 'Libarchive vulnerability can lead to code execution on Linux, FreeBSD, NetBSD'
date: 2019-11-06T02:50:00+01:00
draft: false
---

![archive-compress.jpg](https://zdnet1.cbsistatic.com/hub/i/2019/11/06/b947f00a-2e53-4408-add5-24bf3f95ebc5/8388830ca6d8c679c88d3a41656f91b8/archive-compress.jpg)

Image: Angelo Giordano

A compression library included by default in [Debian](https://www.debian.org/security/2019/dsa-4557), [Ubuntu](https://usn.ubuntu.com/4169-1/), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2019-18408), [Arch Linux](https://www.archlinux.org/packages/?sort=&q=libarchive&maintainer=&flagged=), FreeBSD, and NetBSD distros, contains a vulnerability that can allow hackers to execute code on user machines.

The macOS and Windows operating systems, where this library is also included and used as a default decompression utility, are not affected.

### CVE-2019-18408 in Libarchive

The vulnerability impacts [Libarchive](http://www.libarchive.org/), a library for reading and creating compressed files. It is a powerful all-in-one toolkit for working with archive files that also bundles other Linux/BSD utilities like tar, cpio, and cat, making it ideal for a wide variety of operations, and the reason it's so widely adopted across operating systems.

Last week, details about a major bug impacting the library have [been made public](https://seclists.org/bugtraq/2019/Nov/2) after several Linux and FreeBSD distros rolled out updates containing patches for the Libarchive version they had been shipping out to users.

The bug, tracked under the CVE-2019-18408 identifier, allows an attacker to execute code on a user's system via a malformed archive file.

Exploitation scenarios include users who receive malicious files from attackers or local apps that use Libarchive's various components for file decompression.

The bug was discovered and patched back in June, but it took some time for the patch to make its way upstream to all operating systems. The vulnerability [was identified by Google security researchers](https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=14689) using two automated code testing tools called [ClusterFuzz](https://www.zdnet.com/article/google-weve-open-sourced-clusterfuzz-tool-that-found-16000-bugs-in-chrome/) and [OSS-Fuzz](https://www.zdnet.com/article/googles-automated-fuzz-bot-has-found-over-9000-bugs-in-the-past-two-years/), and [patched in Libarchive 3.4.0](https://github.com/libarchive/libarchive/releases/tag/v3.4.0).

### Could have been much worse

[The list](https://github.com/libarchive/libarchive/wiki/LibarchiveUsers) of vulnerable operating systems and software utilities that ship Libarchive is exhaustive, opening a huge attack surface for malicious threat actors.

It includes desktops and server operating systems, package managers, security utilities, file browsers, and multimedia processing tools. The bigger names include pkgutils, Pacman, CMake, Nautilus, KDE's ark, and Samba.

While the impacted operating systems have rolled out updates to address the reported bug, the patch status of Libarchive in the other apps is currently unknown.

Thankfully, Windows and macOS, today's two most popular operating systems are not impacted; otherwise, the bug would have caused major headaches to users all over the world, just like a [19-year-old WinRAR bug](https://www.zdnet.com/article/winrar-versions-released-in-the-last-19-years-impacted-by-severe-security-flaw/) did [earlier this spring](https://www.zdnet.com/article/100-unique-exploits-and-counting-for-latest-winrar-security-bug/).

At the time of writing, ZDNet is unaware of any public proof-of-concept exploit code for this vulnerability or any in-the-wild exploitation attempts.

![libarchive-1.png](https://www.zdnet.com/article/libarchive-vulnerability-can-lead-to-code-execution-on-linux-freebsd-netbsd/#ftag=RSSbaffb68)

<span><img src="https://zdnet4.cbsistatic.com/hub/i/2019/11/06/99221eb6-0fdf-45bd-bf6c-ba92f36cbaf2/ded5e01727964b904accea01bb196828/libarchive-1.png" alt="libarchive-1.png" /></span>

  
  
from Latest Topic for ZDNet in... https://ift.tt/2PU4J7Z