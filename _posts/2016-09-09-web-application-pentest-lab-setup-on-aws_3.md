---
title: 'Web Application Pentest Lab Setup on AWS'
date: 2019-12-03T09:35:00+01:00
draft: false
---

Isn’t it going to be nice if you can reach your pen-testing lab from all over the world? As we all know, this is a digital age that makes life easier than our expectations, thus anyone can access their information/data from the cloud. Similarly, a Pentester can design its pen-testing environment for the vulnerable machine on the cloud that can be accessed from anywhere. AWS is probably the most popular cloud service available in today’s date, with most companies taking a cloud or hybrid approach towards their infrastructure.

_This article is about setting up a vulnerable lab for web penetration in Amazon Web Services (AWS) to perform pen-testing on._

### Table of Content

*   Prerequisite
*   Setup & Configuration of AWS Instance
*   Deployment & Connectivity
*   Install Dependencies
    *   Apache
    *   MySql – server
    *   PHP
    *   Configuring MySql
    *   Phpmyadmin
*   Lab Setup
    *   DVWA
    *   SQL Injection – Dhakkan
    *   OWASP Mutillidae II

### Prerequisite

To set up your own pen-testing environment, you must have AWS account or if not then create an AWS account and login your account.

### Setup & Configuration of AWS Instance

Let’s walk through the process of setting up the lab, we will be making an EC2 instance with Ubuntu Server 18.04 LTS on it. An EC2 instance is referred to as a virtual server in Amazon’s Elastic Compute Cloud (EC2) for running applications on the AWS infrastructure. The good thing is that this will not cost you anything to build as AWS has options to setup instances within a certain computing level that are not charged for.

1.  Open the **EC2 console** in AWS.

![](https://i0.wp.com/1.bp.blogspot.com/-gC26CiEJrpo/XeYU6QVaKAI/AAAAAAAAhu0/1Sz4yBkuiyoKTs6okW0o97Z7FYNBAuHFwCLcBGAsYHQ/s1600/1.png?w=687&ssl=1)

     2. Navigate to “Launch Instance” and click on “Launch Instance”.

![](https://i0.wp.com/1.bp.blogspot.com/-OjsgICP6mA8/XeYU88B-HZI/AAAAAAAAhvQ/2QCxvKP9JTIw91cD40QERPWz1XecfIW2ACLcBGAsYHQ/s1600/2.png?w=687&ssl=1)

3.  Choose the **Amazon machine image** (AMI), this is basically similar to finding the iso file of the OS that you want on your instance. AWS has you covered with most of the popular OS’s available in its inventory.
4.  Here we looked for ubuntu.
5.  Now that we see the OS that we want running on our instance, we need to choose the “64-bit (x86)”.

![](https://i0.wp.com/1.bp.blogspot.com/-9Cjh9buj5HY/XeYU_ts3UGI/AAAAAAAAhvs/ZjMXj_ePFdkTBX7J-ExJL-Y3tgly06fMwCLcBGAsYHQ/s1600/3.png?w=687&ssl=1)

6.  We now need to choose our instance type, to basically define the amount of hardware this instance will have, we choose the “t2.micro”. This gives us I virtual CPU and 1 GB of RAM.

For most general-purpose workloads, T2 Unlimited instances will provide ample performance without any additional charges.

Features:

*   High-frequency Intel Xeon processors
*   Burstable CPU, governed by CPU Credits, and consistent baseline performance
*   Lowest-cost general purpose instance type, and Free Tier eligible\*
*   Balance of compute, memory, and network resources

Read more from [**here**](https://aws.amazon.com/ec2/instance-types/)

7.  Once we click on “Review and Launch”, the rest of the options are left as they are, and we click on “launch”.

![](https://i1.wp.com/1.bp.blogspot.com/-K6K-OPhZda0/XeYVD3qVZJI/AAAAAAAAhwc/pvQhgEKqtUcpkVKQ1IEFcjmm96TVY9V9QCLcBGAsYHQ/s1600/4.png?w=687&ssl=1)

8\. Now let’s launch the instance which will create a key pair to your instance and complete the launch process.

![](https://i2.wp.com/1.bp.blogspot.com/-Iquvu6AZihw/XeYVENCcCfI/AAAAAAAAhwg/fXXM9wrmgLI1r6mQ5U3hBiyOZGYfyCX_wCLcBGAsYHQ/s1600/5.png?w=687&ssl=1)

This is a very important step, this is what makes it possible for you to connect to your instance over SSH, the key pair.

9.  Choose “Create a new key pair”, give it a name, them download and save the **.pem** file somewhere where you can keep it safe.

![](https://i0.wp.com/1.bp.blogspot.com/-8zddJ3CWxrU/XeYVEUIDKxI/AAAAAAAAhwk/76P6mT86m2wX3NeIH9SIHI-5YvVZfSrMgCLcBGAsYHQ/s1600/6.png?w=687&ssl=1)

AWS gives you the launch status, tells you the about the launch process and shows you that your instance is now launching.

10.  Now click on “View Instances” to see what’s happing with our Ubuntu server. Note that it takes a few minutes for the server to be fully deployed, so be patient. Now we see under “Status check” that we have our 2/2 checks, this essentially means that our instance is fully deployed and ready for us to connect to.

![](https://i2.wp.com/1.bp.blogspot.com/-Y6WjAJDuoCw/XeYVEsmXOMI/AAAAAAAAhwo/QCFyUQkE8O8gyM7VAaATTkZSDE5_AR8rQCLcBGAsYHQ/s1600/7.png?w=687&ssl=1)

### **Deployment & Connectivity**

This is the good part, where we get to deploy and connect to our instance in AWS.

1.  We choose our instance and click on “Connect”, this takes us to a page with options that defines how we want to connect to our instance, and we choose to connect using a standalone SSH client.

![](https://i0.wp.com/1.bp.blogspot.com/-l4jiSOkEOWI/XeYVExJcnxI/AAAAAAAAhws/4ompEby-FWINakpPcHrPCqg4cOKPfMg-QCLcBGAsYHQ/s1600/8.png?w=687&ssl=1)

2.  Enter the name for your Instance ID, so that you can easily identify the instance ID from its name.

![](https://i0.wp.com/1.bp.blogspot.com/-sHv-oBTG36o/XeYVFNYndRI/AAAAAAAAhww/O9PPLzQ1Rqs7Yrhfux7EbTHqP2aQL-nBQCLcBGAsYHQ/s1600/9.png?w=687&ssl=1)

AWS is very helpful in giving us the particulars for our connection, like the commands to use.

![](https://i0.wp.com/1.bp.blogspot.com/-Gcwl2kZ6pzk/XeYU6Vjl2jI/AAAAAAAAhu4/qv9oNxpZM84ty7iHdecnA6p0g2DduzLrQCLcBGAsYHQ/s1600/13.png?w=687&ssl=1)

There are many applications you can choose from to connect to the instance, we are connecting to it from Kali Linux.

3.  We first make sure that the .**pem** file that we saved has the right permissions assigned to it, in this case it needs to be only ‘read’. Once that is done, we put in the SSH particulars provided by AWS.

```
Syntax: ssh -I “key.pem” AMIuser@instance-Public-DNS
```

4.  The .pem file is defined so that the SSH operation knows where the keys are located and that’s it, we are in!!. We connect and get to root.

![](https://i0.wp.com/1.bp.blogspot.com/-nII1tiBky-g/XeYU6UPG4gI/AAAAAAAAhuw/gbs95xPt3Q8788YsLNwwkN81-ZisJOGjwCLcBGAsYHQ/s1600/14.png?w=687&ssl=1)

### **Install Dependencies required for Pentest-lab**

Ubuntu is up and running now, let’s start it for our pentest purposes, in order to do that we need to have the basic dependencies installed so that we can access web application like DVWA, etc.

### **Ap****ache**

First, we will install the Apache. Apache is the most commonly used Web server on Linux Systems. Web servers are used to serve web pages requested by the client computers.

1.  So, let’s first install Apache in the ubuntu by the following command.

```
apt install apache2
```

We have successfully installed apache2, by default apache runs on port 80

![](https://i0.wp.com/1.bp.blogspot.com/-QJWRV9moJx8/XeYU7fJ7dKI/AAAAAAAAhu8/ioRjyD5N_poV6d56mhqlKRifn5DIW9sJgCLcBGAsYHQ/s1600/15.png?w=687&ssl=1) 

For Apache to function properly we need to open port 80, so let’s get to it. We need to edit the security group in order for the Apache service to work. Ports are closed by default in AWS, so we can define what we want open.

2.  Go to your instance and launch the **security groups** **wizard-1**.
3.  Edit the inbound rules and add HTTP, using TCP protocol over port 80.

![](https://i0.wp.com/1.bp.blogspot.com/-IQVHKRQJXjo/XeYU7vCBh-I/AAAAAAAAhvA/dAonCXNmEUg7mXziXXA0sUsQicyD0xmPACLcBGAsYHQ/s1600/16.png?w=687&ssl=1)

4.  The rule has been added, now click on save.

![](https://i1.wp.com/1.bp.blogspot.com/-A-71DOzalok/XeYU70c3xBI/AAAAAAAAhvE/banLndHh8pocfNXyEIap-bE52NxOjQssQCLcBGAsYHQ/s1600/17.png?w=687&ssl=1)

5.  Now to validate that Apache is running on our Ubuntu server, we access the IP of the instance in a browser.

![](https://i0.wp.com/1.bp.blogspot.com/-YafdEfhhIDw/XeYU84NmGUI/AAAAAAAAhvM/T7OsKrGWOLESRBYwJwdylAFR9HemCIjbQCLcBGAsYHQ/s1600/19.png?w=687&ssl=1)

### **MySQL – Server**

The next step is to install MySql-server. This is fairly simple, just type in the command and let Ubuntu do the rest.

```
apt install mysql-server
```

![](https://i2.wp.com/1.bp.blogspot.com/-LtD0xPZSZTQ/XeYU9ZpGVKI/AAAAAAAAhvU/FctDI42XGEE8S8kCftNnudwEocvwz1zBQCLcBGAsYHQ/s1600/20.png?w=687&ssl=1)

### **PHP**

Installing PHP 7.2, simply type the following command.

```
apt install php7.2
```

![](https://i2.wp.com/1.bp.blogspot.com/-dl4kcIG8i1o/XeYU-NzjFyI/AAAAAAAAhvY/wKwO6NTsiOI3-Ph69E93N0-6gWuueuaHwCLcBGAsYHQ/s1600/21.png?w=687&ssl=1)

### **Configuring MySQL**

Let’s configure MySQL so we have the right kind of credentials for our setup. After it gets logged in you will grant all the privileges to the user of Ubuntu as in our case we have given all the privileges to user raj which will be identified with the password of ubuntu which is 123 in our case and after which we will reset all the previous privileges so that it can start the service with the new changes. For this, the commands are the following.

```
mysql -u root -p  
GRANT ALL PRIVILEGES ON \*.\* TO 'raj'@'%' IDENTIFIED BY '123' WITH GRANT OPTION;  
flush privileges;
```

![](https://i0.wp.com/1.bp.blogspot.com/-vO_siqp0zNI/XeYU-KZ9PLI/AAAAAAAAhvc/xQ4EXDRYynEIDIeQvYLOM3v_cxbOhqLUACLcBGAsYHQ/s1600/22.png?w=687&ssl=1)

### **PHPMyAdmin**

We need to install phpMyAdmin as well, here is how you do it.

```
apt install phpmyadmin
```

![](https://i0.wp.com/1.bp.blogspot.com/-rQjib7FNsso/XeYU-gBOp9I/AAAAAAAAhvg/olyXiF1NKzosp-p5P24eU-CJ9kybNPl9ACLcBGAsYHQ/s1600/23.png?w=687&ssl=1)

Phpmyadmin needs to be configured, it needs to know that we want to use apache2 as our web server.

Next, we need to give it the password that we kept while setting up MySQL.

![](https://i0.wp.com/1.bp.blogspot.com/-DOYBdpPA-aw/XeYU-q6eG5I/AAAAAAAAhvk/JdY_YurTU-ciDQjewJup-UY9PFzLiiwrQCLcBGAsYHQ/s1600/24.png?w=687&ssl=1)

### **Lab Setup**

We are done with installing all the dependencies for our setup and are now ready to install our pentest labs.

### **DVWA**

let’s navigate to the “html” folder to download and install DVWA. Once that is done, we need to move the config.inc.php.dist file for further configurations.

```
cd /var/www/html  
git clone https://github.com/ethicalhack3r/DVWA  
cd /dvwa/config  
mv config.inc.php.dist config.inc.php
```

![](https://i0.wp.com/1.bp.blogspot.com/-f3-d5hSnugM/XeYU_xvJ9vI/AAAAAAAAhvw/_f_txdynp34ht8FAuOltjcL2qdc3SUS-QCLcBGAsYHQ/s1600/29.png?w=687&ssl=1)

Open the **config.inc.php** file in a text editor and put in the database credentials that we had set up earlier. We only need to modify 2 fields: db\_user and db\_password.

![](https://i0.wp.com/1.bp.blogspot.com/-yZul3ZxZ0HY/XeYVAER2d7I/AAAAAAAAhv0/afkcwTXtvZogW2rF0ZLyHfR42qtCAnkvwCLcBGAsYHQ/s1600/30.png?w=687&ssl=1)

Now we open DVWA in our web browser and click on “Create/Reset Database”.

![](https://i0.wp.com/1.bp.blogspot.com/-KMhEeKpH04U/XeYVA3_0ZhI/AAAAAAAAhv4/iRI67JSBlToEGgaIhTX5upkhXlY6sxCLQCLcBGAsYHQ/s1600/31.png?w=687&ssl=1)

Time, to login to our DVWA!

![](https://i0.wp.com/1.bp.blogspot.com/-8epj65HQuVc/XeYVBMBvbmI/AAAAAAAAhv8/v_gklx3y4yo91_e9xNS5FIAZTGWjXgdvgCLcBGAsYHQ/s1600/32.png?w=687&ssl=1)

### **SQL Injection – Dhakkan**

Our vulnerable web app is up and running, now we want to install a lab for SQL injections, we will be using the Dhakkan sqli lab.

Here’s how to set it up. We download it into the html folder to host it, next we move the “sqlilabs” folder to the “sqli”. Next, we need to edit the database credentials so that the lab can function properly. Open the db-creds.inc file in a text editor.

```
git clone http://github.com/Rinkish/Sqli\_Edited\_Version  
cd Sqli\_Edited\_Version/  
ls  
mv sqlilabs/ ../sqli  
cd sqli  
cd sql-connections/
```

![](https://i2.wp.com/1.bp.blogspot.com/-4o1odL3G3LE/XeYVBYCTXEI/AAAAAAAAhwA/9HoUTh86Oac9z1tlywOac21b6r1jnyr3ACLcBGAsYHQ/s1600/33.png?w=687&ssl=1)

Now that the file is open, we put in the username and password.

![](https://i1.wp.com/1.bp.blogspot.com/-i45SjtPTVKA/XeYVBlJL8SI/AAAAAAAAhwE/XswECxbrQwox0BUaEtb6LzqdOLVTyFTdACLcBGAsYHQ/s1600/34.png?w=687&ssl=1)

Now browse this web application from through this Public-DNS/sqli and click on Setup/reset Databases for labs. Now the sqli lab is ready to use.

![](https://i0.wp.com/1.bp.blogspot.com/-dletfa7YTPM/XeYVCJ3324I/AAAAAAAAhwI/6c3VBU5QeksuDDyiFhD8shwvnkCvCWM-wCLcBGAsYHQ/s1600/35.png?w=687&ssl=1)

Success! Sqli is up and running.

![](https://i2.wp.com/1.bp.blogspot.com/-QRnzD-hS9dA/XeYVCSc01nI/AAAAAAAAhwM/1N_Kh8NhBDsrqfEFVAvybGy4XKg0u8iXQCLcBGAsYHQ/s1600/36.png?w=687&ssl=1)

### **OWASP Mutillidae II**

Last but not least, we will install OWASP Mutillidae II and that will conclude our setup for now.

So, let’s start by navigating to the “html” folder and downloading Mutillidae. Once downloaded, we navigate to the “includes” folder.

```
git clone https://github.com/webpwnized/mutillidae  
cd mutillidae  
cd includes  
ls  
nano database-config.inc
```

![](https://i0.wp.com/1.bp.blogspot.com/-9LoNJLngFEg/XeYVCpCYwOI/AAAAAAAAhwQ/8yJw97amY1sxrxpWeDUKoCiGCmrEGQKLgCLcBGAsYHQ/s1600/37.png?w=687&ssl=1)

Once in, modify the database access file to prove the credentials we had set up earlier.

![](https://i2.wp.com/1.bp.blogspot.com/-EmEb4UK37qo/XeYVDNvJ4OI/AAAAAAAAhwU/T049PEqAirEsFBtDaKD5-BE9NKkcecV7QCLcBGAsYHQ/s1600/38.png?w=687&ssl=1)

Now we will open this our local browser by the following URL: Public-DNS/mutillidae where we will find an option of reset database. Just click on it to reset the database. Let’s launch Mutillidae using our browser.

![](https://i2.wp.com/1.bp.blogspot.com/-LFOBltxZw8U/XeYVDlwFwoI/AAAAAAAAhwY/WxFrDlm46L0moSM1UYbEgk7YlnIbkGq7gCLcBGAsYHQ/s1600/39.png?w=687&ssl=1)

Voila!! Your Ubuntu instance is ready for you to start your AWS pentest journey. You have your connectivity, dependencies and labs all configured and ready to go.

We at Hacking Articles always try to bring you the most industry-relevant content. Since the cloud is now the thing most companies are moving towards and raising curiosity about ways to keep the cloud secure, this is article is just to get you ready for our new articles on cloud penetration testing, so stay tuned.

Have fun and stay ethical.

**About The Author**

Abhimanyu Dev is a Certified Ethical Hacker, penetration tester, information security analyst and researcher. Connect with him [**here**](https://www.linkedin.com/in/abhimanyudev)

The post [Web Application Pentest Lab Setup on AWS](https://www.hackingarticles.in/web-application-pentest-lab-setup-on-aws/) appeared first on [Hacking Articles](https://www.hackingarticles.in).

  
  
from Hacking Articles https://ift.tt/35VjEU9